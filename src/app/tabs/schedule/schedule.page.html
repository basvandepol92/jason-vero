<ion-header [translucent]="true">
  <ion-toolbar class="schedule-toolbar">
    <ion-title>Jason & Veer - Always forever</ion-title>
    <ion-buttons slot="end">
      <!-- Search icon logic could go here later -->
    </ion-buttons>
  </ion-toolbar>

  <ion-toolbar class="segment-toolbar">
    <ion-segment [value]="selectedDay()" (ionChange)="dayChanged($event)" scrollable mode="md">
      @for (day of days(); track day) {
      <ion-segment-button [value]="day">
        <ion-label>
          <div class="day-label">{{ day }}</div>
        </ion-label>
      </ion-segment-button>
      }
    </ion-segment>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">

  <div class="page-title">
    <h2>{{ selectedDay() }} Schedule</h2>
  </div>

  <div class="timeline-container">
    @for (item of displayedItems(); track item.id; let last = $last) {
    <app-timeline-item [item]="item" [isLive]="checkLive(item)" [isLast]="last" (clicked)="openDetails(item)">
    </app-timeline-item>
    } @empty {
    <div class="empty-state">
      <p>No events scheduled for this day.</p>
    </div>
    }
  </div>



  <ion-modal [isOpen]="isModalOpen()" (didDismiss)="closeModal()">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-title>Event Details</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="closeModal()">Close</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding">
        @if (selectedItem(); as item) {
        <div class="modal-content">
          @if (item.image) {
          <div class="event-image">
            <img [src]="item.image | directusImg:'width=600'" alt="{{ item.title }}">
          </div>
          }
          <h2>{{ item.title }}</h2>
          <div class="meta-info">
            <p><strong>Time:</strong> {{ item.start_time | date:'shortTime' }} - {{ item.end_time | date:'shortTime' }}
            </p>
            <p><strong>Location:</strong> {{ item.location }}</p>
          </div>

          @if (item.description) {
          <div class="description" [innerHTML]="item.description"></div>
          }

          @if (item.artist) {
          <div class="artist-section">
            <h3>Artist</h3>
            <p>{{ item.artist }}</p>
          </div>
          }
        </div>
        }
      </ion-content>
    </ng-template>
  </ion-modal>

</ion-content>